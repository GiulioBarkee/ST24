---
import { getCollection } from "astro:content";

const { hideHeader, limit } = Astro.props;
let circolariList = await getCollection("circolari");
circolariList.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

if (limit !== undefined) {
  circolariList = circolariList.slice(0, limit);
}
---

<section>
  <div class="news-grid">
    {
      circolariList.map((circolare) => (
        <a href={`/circolari/${circolare.slug}/`} class="circolare">
          <div class="circolare-meta">
            <li class="li">
              <span class="circolare-category">Circolare</span>
              <span class="circolare-date">
                {new Date(circolare.data.date).toLocaleDateString("it-IT")}
              </span>
            </li>
          </div>
          <h3 class="circolare-title">{circolare.data.title}</h3>
        </a>
      ))
    }
    {
      !hideHeader && (
        <a href="" class="button">
          TUTTE LE CIRCOLARI
          <img class="button-icon" src="/assets/arrow-right.png" alt="" />
        </a>
      )
    }
  </div>
</section>

<style lang="scss">
  section {
    padding: var(--padding-viewport);
    font-family: "Aspekta";
    color: #4c4c4c;
    .news-grid {
      display: flex;
      flex-flow: column;
    }
    .circolare {
      display: flex;
      flex-flow: column;
      gap: 1rem;
      border-bottom: 1px solid #dedede;
      margin-top: 1rem;
      .circolare-category {
        margin-right: 2rem;
      }
      .circolare-title {
        font-size: 1.1rem;
        font-weight: 500;
      }
      .li {
        list-style-type: disc;
        color: #243a3a;
      }
      h3 {
        margin-bottom: 1rem;
      }
    }
    .button {
      @media (max-width: 768px) {
        margin-bottom: 5rem;
        margin-bottom: 5rem;
        width: fit-content;
        align-self: flex-end;
        margin-top: 3rem;
      }
      @media (min-width: 768px) {
        display: none;
      }
    }
  }
</style>
