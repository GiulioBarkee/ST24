---
import { getCollection } from "astro:content";

const { limit } = Astro.props;
let circolariList = await getCollection("circolari");
circolariList.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

if (limit !== undefined) {
  circolariList = circolariList.slice(0, limit);
}
---

<section>
  <div class="news-grid">
    {
      circolariList.map((circolare) => (
        <a href={`/circolari/${circolare.slug}/`} class="circolare">
          <div class="circolare-meta">
            <li class="li">
              <span class="circolare-category">Circolare</span>
              <span class="circolare-date">
                {new Date(circolare.data.date).toLocaleDateString("it-IT")}
              </span>
            </li>
          </div>
          <h3 class="circolare-title">{circolare.data.title}</h3>
        </a>
      ))
    }
    <a href="" class="action-button">
      TUTTE LE CIRCOLARI
      <span class="button-icon">â†’</span>
    </a>
  </div>
</section>

<style lang="scss">
  section {
    padding: var(--padding-viewport);
    .news-grid {
      display: flex;
      flex-flow: column;
    }
    .circolare {
      display: flex;
      flex-flow: column;
      gap: 1rem;
      border-bottom: 1px solid #dedede;
      margin-top: 1rem;
      .circolare-category {
        margin-right: 2rem;
      }
      .circolare-title {
        font-size: 1.1rem;
        font-weight: 500;
      }
      .li {
        list-style-type: disc;
      }
      h3 {
        margin-bottom: 1rem;
      }
    }
    .action-button {
      display: inline-flex;
      align-items: center;
      padding: 0.75rem 1.5rem;
      border: 2px solid #333;
      border-radius: 50px;
      font-size: 1rem;
      color: #333;
      text-decoration: none;
      transition: all 0.3s ease;
      margin-top: 3rem;
      align-self: flex-end;
      @media (max-width: 768px) {
        margin-bottom: 5rem;
      }

      @media (min-width: 768px) {
        display: none;
      }
    }
  }
</style>
